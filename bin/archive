#! /usr/bin/env python

'''
Rudimentary command line tool for Archive.  Try:
  ./bin/archive [your-archive-module] [your-relation] graph
  ./bin/archive [your-archive-module] [your-relation] stats
  ./bin/archive [your-archive-module] [your-relation] hql
  ./bin/archive [your-archive-module] [your-relation] create_all_hql

Where [your-archive-module] is of the form: "my.package.module" and
[your-relation] is the unqualified name of the relation you want to operate on.
'''

import sys
import importlib

archive_module = sys.argv[1]
relation_name = sys.argv[2]
command = sys.argv[3]

archive_module = importlib.import_module(archive_module)
archive = getattr(archive_module, 'archive')
relation = archive.lookup(relation_name)

if command == 'stats':
  import pprint
  pprint.pprint(relation.stats())
else:
  method = getattr(relation, command)
  print method()
